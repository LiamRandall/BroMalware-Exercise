##! Extract and include the header names used for each request in the HTTP
##! logging stream.  The headers in the logging stream will be stored in the
##! same order which they were seen on the wire.
 
@load base/protocols/http/main
 
module HTTP;
 
export {
		
}
 
event http_header(c: connection, is_orig: bool, name: string, value: string) &priority=3
	{
	if ( ! c?$http )
		return;

	print name;
	print value;
	
	if ( is_orig )
		{
			{
			if ( ! c$http?$client_header_names )
				c$http$client_header_names = vector();
			c$http$client_header_names[|c$http$client_header_names|] = name;
			if ( ! c$http?$client_header_values)
				c$http$client_header_values = vector();
			c$http$client_header_values[|c$http$client_header_values|] = value;
			}
		}
	else
		{
			{
			if ( ! c$http?$server_header_names )
				c$http$server_header_names = vector();
			c$http$server_header_names[|c$http$server_header_names|] = name;
			if ( ! c$http?$server_header_values )
				c$http$server_header_values = vector();
			c$http$server_header_values[|c$http$server_header_values|] = value;
			}
		}
	}
